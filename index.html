<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙØ§Ø­Øµ Ø§Ù„Ø¬Ù„Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; background: #f4f4f4; }
        video { width: 100%; max-width: 400px; border-radius: 15px; border: 3px solid #333; }
        #status { font-size: 1.2rem; margin: 20px; font-weight: bold; color: #333; padding: 10px; background: #fff; border-radius: 8px; }
        button { padding: 15px 30px; background: #007bff; color: white; border: none; border-radius: 8px; font-size: 1rem; cursor: pointer; }
    </style>
</head>
<body>

    <h2>Ø§Ù„ØªØ´Ø®ÙŠØµ Ø§Ù„Ø°ÙƒÙŠ (Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©)</h2>
    <video id="webcam" autoplay playsinline muted></video>
    <div id="status">Ø¬Ø§Ù‡Ø².. Ø§Ø¶ØºØ· ØªØ´ØºÙŠÙ„</div>
    <button onclick="init()">ØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…</button>

    <script src="https://202410091-afk.github.io/Ai-check-/edge-impulse-standalone.js"></script>

    <script>
        async function init() {
            const status = document.getElementById('status');
            const video = document.getElementById('webcam');

            try {
                // 1. Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
                status.innerText = "1. Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§...";
                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
                video.srcObject = stream;

                // 2. ÙØ­Øµ Ù…Ù„Ù JS
                status.innerText = "2. Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ù„Ù Ø§Ù„ØªØ´ØºÙŠÙ„...";
                if (typeof EdgeImpulseClassifier === 'undefined') {
                    throw new Error("Ù…Ù„Ù JS ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯! ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ø§Ø¨Ø· ØµØ­ÙŠØ­ Ø£Ùˆ Ø§Ù„Ù…Ù„Ù Ù…Ø±ÙÙˆØ¹.");
                }

                // 3. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„
                status.innerText = "3. Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø°ÙƒØ§Ø¡ (8MB)... Ù‚Ø¯ ÙŠØ£Ø®Ø° Ø¯Ù‚ÙŠÙ‚Ø©";
                const classifier = new EdgeImpulseClassifier();
                await classifier.init();
                
                status.innerText = "âœ… ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­! ÙˆØ¬Ù‡ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§";
                status.style.color = "green";

                // 4. Ø§Ù„ØªØµÙ†ÙŠÙ
                setInterval(async () => {
                    const result = await classifier.classify(video);
                    if (result.results.length > 0) {
                        const top = result.results[0];
                        status.innerText = `${top.label} (${(top.value * 100).toFixed(0)}%)`;
                    }
                }, 1000);

            } catch (error) {
                // Ù‡Ù†Ø§ Ø³ÙŠØ¸Ù‡Ø± Ù„Ù†Ø§ Ø³Ø¨Ø¨ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
                status.innerText = "ğŸ›‘ Ø®Ø·Ø£: " + error.message;
                status.style.color = "red";
                console.error(error);
            }
        }
    </script>
</body>
</html>
